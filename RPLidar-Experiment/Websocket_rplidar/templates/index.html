</html>
<!doctype html>
<html lang="en">
<head>
    <title>lidar websocket experiment</title>
</head>
<body>
    <canvas id="graph" width="700" height="700"></canvas>
</body>
<script src="https://cdn.socket.io/3.1.3/socket.io.min.js" integrity="sha384-cPwlPLvBTa3sKAgddT6krw0cJat7egBga3DJepJyrLl4Q9/5WLra3rrnMcyTyOnh" crossorigin="anonymous"></script>
<script>
//SETUP
//websocket
var socket = io();
//distanceDiv
var distanceDiv = document.getElementById('distanceDiv');
const SCREEN_WIDTH = 700;
const SCREEN_HEIGHT = 700;
const MIN_DISTANCE = 0;
const MAX_DISTANCE = 6000;
var graph = document.getElementById('graph');
var ctx = graph.getContext("2d");

//LISTENERS
socket.on('connect', function(){
    console.log('connected');
    socket.emit('needLidar');
});
socket.on('disconnect', function(){
    console.log('disconnected');
});
socket.on('scanData', function(data) {
    for (let i=0;i<360;i++) {
        x = data[i]*Math.cos(i);
        y = data[i]*Math.sin(i);
        x = (SCREEN_WIDTH/2) + (SCREEN_WIDTH * x/MAX_DISTANCE);
        y = (SCREEN_HEIGHT/2) + (SCREEN_HEIGHT * y/MAX_DISTANCE);
        ctx.fillRect(x,y,1,1);
    }
});
</script>
</html>